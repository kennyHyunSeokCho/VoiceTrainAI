# ğŸšï¸ í•˜ë“œì½”ë”©ëœ ë°ì‹œë²¨ ì„ê³„ê°’ ì‹œìŠ¤í…œ

ì´ ì‹œìŠ¤í…œì€ **í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ê²€ì¦ëœ ìµœì ì˜ ì„ê³„ê°’**ì„ í•˜ë“œì½”ë”©í•˜ì—¬ ì•ˆì •ì ì´ê³  ì¼ê´€ëœ ìŒì„± ê°ì§€ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ¯ ì™œ í•˜ë“œì½”ë”© ë°©ì‹ì„ ì„ íƒí–ˆë‚˜ìš”?

### âŒ ê¸°ì¡´ UI ì¡°ì • ë°©ì‹ì˜ ë¬¸ì œì 
- ë³µì¡í•œ ìŠ¬ë¼ì´ë”ì™€ í”„ë¦¬ì…‹ ë²„íŠ¼ë“¤ë¡œ ì¸í•œ ì‚¬ìš©ì í˜¼ë€
- ì˜ëª»ëœ ì„¤ì •ìœ¼ë¡œ ì¸í•œ ë°°ê²½ ì¡ìŒ ë…¹ìŒ ë¬¸ì œ
- ì„ê³„ê°’ ì¡°ì •ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠëŠ” ë¶ˆì•ˆì •ì„±
- ê³¼ë„í•œ UI ë³µì¡ì„±ìœ¼ë¡œ ì¸í•œ ì„±ëŠ¥ ì €í•˜

### âœ… í•˜ë“œì½”ë”© ë°©ì‹ì˜ ì¥ì 
- **ì•ˆì •ì„±**: í…ŒìŠ¤íŠ¸ëœ ìµœì ê°’ìœ¼ë¡œ ì¼ê´€ëœ ì„±ëŠ¥ ë³´ì¥
- **ë‹¨ìˆœì„±**: ë³µì¡í•œ UI ì¡°ì • ì—†ì´ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥
- **ì„±ëŠ¥**: ë™ì  ì¡°ì • ë¡œì§ ì œê±°ë¡œ ë” ë¹ ë¥¸ ì²˜ë¦¬
- **ìœ ì§€ë³´ìˆ˜**: ì½”ë“œê°€ ë‹¨ìˆœí•´ì ¸ ë²„ê·¸ ê°€ëŠ¥ì„± ê°ì†Œ
- **ì‚¬ìš©ì ê²½í—˜**: ì„¤ì •ì— ì‹ ê²½ ì“¸ í•„ìš” ì—†ì´ ì¦‰ì‹œ ì‚¬ìš©

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
frontend/lib/features/record/models/
â”œâ”€â”€ audio_threshold_settings.dart    # í•˜ë“œì½”ë”©ëœ ì„ê³„ê°’ ì„¤ì • ê´€ë¦¬
â”œâ”€â”€ audio_level_monitor.dart         # ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ ë ˆë²¨ ëª¨ë‹ˆí„°ë§
â””â”€â”€ README.md                       # ì´ ë¬¸ì„œ

frontend/lib/features/record/widgets/
â””â”€â”€ audio_threshold_control_widget.dart  # ë‹¨ìˆœí™”ëœ ìƒíƒœ í‘œì‹œ ìœ„ì ¯

frontend/lib/features/record/providers/
â””â”€â”€ recording_provider.dart         # ë©”ì¸ í”„ë¡œë°”ì´ë” (ì„¤ì • ë³€ê²½ ë©”ì„œë“œ ì œê±°ë¨)
```

## ğŸ”§ í•µì‹¬ êµ¬ì„± ìš”ì†Œ

### 1. AudioThresholdSettings (í•˜ë“œì½”ë”©ëœ ì„ê³„ê°’ ê´€ë¦¬)

**ìµœì í™”ëœ ì„ê³„ê°’ë“¤**:
- **ìŒì„± ê°ì§€ ì„ê³„ê°’**: `60dB` (ì¼ë°˜ì ì¸ ëŒ€í™” ìˆ˜ì¤€)
- **ë¬´ìŒ ê°ì§€ ì„ê³„ê°’**: `35dB` (ì™„ì „í•œ ì¹¨ë¬µ ìƒíƒœ)
- **í•„í„°ë§ í™œì„±í™”**: `í•­ìƒ true` (ì„¤ì • ë³€ê²½ ë¶ˆê°€)

**ì£¼ìš” íŠ¹ì§•**:
```dart
// í•˜ë“œì½”ë”©ëœ ìµœì ê°’ë“¤
static const double _VOICE_THRESHOLD = 60.0;      // ìŒì„± ê°ì§€
static const double _SILENCE_THRESHOLD = 35.0;    // ë¬´ìŒ ê°ì§€
static const bool _IS_ENABLED = true;             // í•­ìƒ í™œì„±í™”

// ì‚¬ìš©ì ì¹œí™”ì ì¸ ìƒíƒœ í™•ì¸
bool get isAboveThreshold;     // í˜„ì¬ ìŒì„± ê°ì§€ë¨?
bool get isSilent;             // í˜„ì¬ ë¬´ìŒ ìƒíƒœ?
String get voiceStatusDescription;  // í˜„ì¬ ìƒíƒœ ì„¤ëª…
```

### 2. AudioLevelMonitor (ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ ë ˆë²¨ ê°ì§€)

**í•µì‹¬ ê¸°ëŠ¥**:
- **100ms ê°„ê²©** ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ ë ˆë²¨ ì¸¡ì •
- **Amplitude â†’ ë°ì‹œë²¨** ë³€í™˜ (20dB ~ 90dB)
- **ì„ê³„ê°’ ë¹„êµ** ë° ìƒíƒœ ë³€í™” ê°ì§€
- **ì½œë°± ì•Œë¦¼**ì„ í†µí•œ ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸

**ì‚¬ìš© íë¦„**:
```dart
// 1. ëª¨ë‹ˆí„°ë§ ì‹œì‘
await monitor.startMonitoring(
  thresholdDecibel: 60.0,
  onLevelUpdate: (level) => updateUI(level),
  onThresholdChange: (isAbove) => controlRecording(isAbove),
);

// 2. ì‹¤ì‹œê°„ ìƒíƒœ í™•ì¸
bool isVoice = monitor.isAboveThreshold(60.0);

// 3. ëª¨ë‹ˆí„°ë§ ì¤‘ì§€
await monitor.stopMonitoring();
```

### 3. AudioThresholdControlWidget (ë‹¨ìˆœí™”ëœ ìƒíƒœ í‘œì‹œ)

**ê¸°ì¡´ ë³µì¡í•œ UI ì œê±°**:
- âŒ ì„ê³„ê°’ ì¡°ì ˆ ìŠ¬ë¼ì´ë”
- âŒ í”„ë¦¬ì…‹ ì„ íƒ ë²„íŠ¼ë“¤
- âŒ í™œì„±í™”/ë¹„í™œì„±í™” ìŠ¤ìœ„ì¹˜
- âŒ ë³µì¡í•œ ì„¤ì • ì €ì¥/ë¡œë“œ

**ìƒˆë¡œìš´ ë‹¨ìˆœí•œ UI**:
- âœ… í˜„ì¬ ì„ê³„ê°’ ì •ë³´ í‘œì‹œ (ë³€ê²½ ë¶ˆê°€)
- âœ… ì‹¤ì‹œê°„ ìŒì„± ìƒíƒœ í‘œì‹œ
- âœ… ì§ê´€ì ì¸ ë ˆë²¨ ë°”ì™€ ë²”ë¡€
- âœ… ëª¨ë‹ˆí„°ë§ ìƒíƒœ í‘œì‹œ

## ğŸ¤ ìŒì„± ìƒíƒœ ë¶„ë¥˜

ì‹œìŠ¤í…œì€ í˜„ì¬ ì…ë ¥ì„ 3ê°€ì§€ ìƒíƒœë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤:

### ğŸ”‡ ë¬´ìŒ ìƒíƒœ (35dB ì´í•˜)
- ê±°ì˜ ì™„ì „í•œ ì¹¨ë¬µ
- ì‚¬ìš©ìê°€ ë§ì„ í•˜ì§€ ì•ŠëŠ” ìƒíƒœ
- ë§¤ìš° ì‘ì€ ë°°ê²½ ì†ŒìŒë§Œ ì¡´ì¬

### ğŸ”Š ë°°ê²½ìŒ (35dB ì´ˆê³¼ ~ 60dB ë¯¸ë§Œ)
- ë°°ê²½ ì¡ìŒì´ë‚˜ ì‘ì€ ì†Œë¦¬
- ìŒì„±ì´ ì•„ë‹Œ ì†ŒìŒìœ¼ë¡œ íŒë‹¨
- ë…¹ìŒì— í¬í•¨ë˜ì§€ ì•ŠìŒ

### ğŸ¤ ìŒì„± ê°ì§€ë¨ (60dB ì´ìƒ)
- ëª…í™•í•œ ìŒì„±ìœ¼ë¡œ íŒë‹¨
- ì¼ë°˜ì ì¸ ëŒ€í™” ìˆ˜ì¤€ì˜ ì†Œë¦¬
- ì‹¤ì œ ë…¹ìŒì´ ì§„í–‰ë¨

## âš™ï¸ ì‹œìŠ¤í…œ ì‘ë™ ì›ë¦¬

### 1. ë…¹ìŒ ì‹œì‘ ì‹œ
```
1. AudioLevelMonitor ìë™ ì‹œì‘
2. ë§ˆì´í¬ ê¶Œí•œ í™•ì¸
3. amplitude ìŠ¤íŠ¸ë¦¼ êµ¬ë… (100ms ê°„ê²©)
4. í•˜ë“œì½”ë”©ëœ ì„ê³„ê°’(60dB) ì ìš©
```

### 2. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
```
1. ë§ˆì´í¬ ì…ë ¥ â†’ raw amplitude (0.0~1.0)
2. amplitude â†’ ë°ì‹œë²¨ ë³€í™˜ (20~90dB)
3. 60dB ì„ê³„ê°’ê³¼ ë¹„êµ
4. ìƒíƒœ ë³€í™” ì‹œ ì¦‰ì‹œ ì½œë°± í˜¸ì¶œ
5. UI ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
```

### 3. ìŒì„± ê°ì§€ ë¡œì§
```
if (í˜„ì¬ë ˆë²¨ > 60dB) {
    // ğŸ¤ ìŒì„± ê°ì§€ë¨ â†’ ì‹¤ì œ ë…¹ìŒ ì§„í–‰
    ì‹¤ì œ_ë…¹ìŒ_ìƒíƒœ = true;
    ìŒì„±_ëŒ€ê¸°_ìƒíƒœ = false;
} else {
    // ğŸ”Š ë°°ê²½ìŒ ë˜ëŠ” ğŸ”‡ ë¬´ìŒ â†’ ë…¹ìŒ ì¼ì‹œì •ì§€
    ì‹¤ì œ_ë…¹ìŒ_ìƒíƒœ = false;
    ìŒì„±_ëŒ€ê¸°_ìƒíƒœ = true;
}
```

## ğŸ“Š ì„ê³„ê°’ ìƒì„¸ ë¶„ì„

### 60dB ìŒì„± ì„ê³„ê°’ ì„ íƒ ì´ìœ 

**ì‹¤ì œ í™˜ê²½ í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
- âœ… ì¼ë°˜ì ì¸ ëŒ€í™” ì†Œë¦¬ (65-75dB) ì™„ë²½ ê°ì§€
- âœ… ì‘ì€ ëª©ì†Œë¦¬ (60-65dB) ì•ˆì •ì  ê°ì§€
- âœ… ì—ì–´ì»¨ ì†ŒìŒ (45-55dB) íš¨ê³¼ì  ì°¨ë‹¨
- âœ… í‚¤ë³´ë“œ íƒ€ì´í•‘ (50-60dB) ëŒ€ë¶€ë¶„ ì°¨ë‹¨
- âœ… TV/ìŒì•… ë°°ê²½ìŒ (40-60dB) ì•ˆì •ì  ì°¨ë‹¨

**ë‹¤ë¥¸ ì„ê³„ê°’ê³¼ ë¹„êµ**:
| ì„ê³„ê°’ | ì¥ì  | ë‹¨ì  |
|--------|------|------|
| 50dB | ë§¤ìš° ë¯¼ê°í•œ ê°ì§€ | ë°°ê²½ ì¡ìŒ í¬í•¨ ìœ„í—˜ |
| 55dB | ì‘ì€ ëª©ì†Œë¦¬ë„ ê°ì§€ | ì—¬ì „íˆ ì¡ìŒ ê°€ëŠ¥ì„± |
| **60dB** | **ìµœì ì˜ ê· í˜•** | **ê±°ì˜ ì™„ë²½** |
| 65dB | ë§¤ìš° ê¹¨ë—í•œ ìŒì„±ë§Œ | ì‘ì€ ëª©ì†Œë¦¬ ë†“ì¹  ìœ„í—˜ |
| 70dB | í° ëª©ì†Œë¦¬ë§Œ ê°ì§€ | ì¼ë°˜ ëŒ€í™” ë†“ì¹  ìœ„í—˜ |

### 35dB ë¬´ìŒ ì„ê³„ê°’ ì„ íƒ ì´ìœ 

**ë¬´ìŒ ìƒíƒœ ì •í™•í•œ ê°ì§€**:
- ğŸ  ì¡°ìš©í•œ ì‹¤ë‚´: 25-35dB
- ğŸ“š ë„ì„œê´€: 30-40dB  
- ğŸŒ™ ê¹Šì€ ë°¤: 20-30dB
- ğŸ’» ì»´í“¨í„° íŒ¬: 35-45dB

35dBë¥¼ ì„ íƒí•¨ìœ¼ë¡œì¨ ì§„ì •í•œ "ë¬´ìŒ"ê³¼ "ì‘ì€ ì†ŒìŒ"ì„ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ“± ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ

### RecordingProvider í†µí•©
```dart
class RecordingProvider extends ChangeNotifier {
  final AudioThresholdSettings _thresholdSettings = AudioThresholdSettings();
  final AudioLevelMonitor _levelMonitor = AudioLevelMonitor();
  
  // í•˜ë“œì½”ë”©ëœ ì„ê³„ê°’ ì‚¬ìš©
  Future<void> startRecording() async {
    await _levelMonitor.startMonitoring(
      thresholdDecibel: _thresholdSettings.threshold, // 60dB
      onLevelUpdate: (level) {
        _thresholdSettings.updateCurrentLevel(level);
      },
      onThresholdChange: (isAbove) {
        // ìŒì„± ê°ì§€/ë¯¸ê°ì§€ì— ë”°ë¥¸ ë…¹ìŒ ì œì–´
        _handleVoiceDetection(isAbove);
      },
    );
  }
}
```

### UIì—ì„œ ìƒíƒœ í‘œì‹œ
```dart
class AudioThresholdControlWidget extends StatelessWidget {
  Widget build(BuildContext context) {
    return Consumer<RecordingProvider>(
      builder: (context, provider, child) {
        final settings = provider.thresholdSettings;
        
        return Column(
          children: [
            // í•˜ë“œì½”ë”©ëœ ì„ê³„ê°’ ì •ë³´ (ë³€ê²½ ë¶ˆê°€)
            Text('ìµœì í™”ëœ ì„ê³„ê°’: ${settings.threshold.toInt()}dB'),
            Text(settings.thresholdDescription),
            
            // í˜„ì¬ ìƒíƒœ í‘œì‹œ
            Text(settings.voiceStatusDescription),
            Text('í˜„ì¬ ë ˆë²¨: ${settings.currentLevel.toStringAsFixed(1)}dB'),
            
            // ì‹¤ì‹œê°„ ë ˆë²¨ ë°”
            AudioLevelIndicator(),
          ],
        );
      },
    );
  }
}
```

## ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### ê¸°ì¡´ ì½”ë“œì—ì„œ ë³€ê²½ëœ ë¶€ë¶„

**ì œê±°ëœ ë©”ì„œë“œë“¤**:
```dart
// âŒ ë” ì´ìƒ ì‚¬ìš© ë¶ˆê°€
recordingProvider.setThreshold(55.0);
recordingProvider.setThresholdEnabled(false);
recordingProvider.setThresholdPreset('ë¯¼ê°í•¨');

// âŒ ì œê±°ëœ í´ë˜ìŠ¤
AudioThresholdPresets.getThresholdByName('ë³´í†µ');
```

**ìƒˆë¡œìš´ ì‚¬ìš©ë²•**:
```dart
// âœ… í•˜ë“œì½”ë”©ëœ ê°’ í™•ì¸
final threshold = thresholdSettings.threshold; // í•­ìƒ 60.0
final isEnabled = thresholdSettings.isEnabled; // í•­ìƒ true

// âœ… ìƒíƒœ í™•ì¸
final isVoice = thresholdSettings.isAboveThreshold;
final isSilent = thresholdSettings.isSilent;
final status = thresholdSettings.voiceStatusDescription;
```

## âš ï¸ ì£¼ì˜ì‚¬í•­ ë° ì œí•œì‚¬í•­

### ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
1. **ë§ˆì´í¬ ê¶Œí•œ**: í•„ìˆ˜ (ìë™ìœ¼ë¡œ ìš”ì²­)
2. **í”Œë«í¼ ì§€ì›**: record íŒ¨í‚¤ì§€ ì§€ì› í”Œë«í¼
3. **ì„±ëŠ¥**: ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ì•½ê°„ì˜ CPU ì‚¬ìš©

### ì„ê³„ê°’ ë³€ê²½ì´ í•„ìš”í•œ ê²½ìš°
í•˜ë“œì½”ë”©ëœ ê°’ì„ ë³€ê²½í•˜ë ¤ë©´:

```dart
// AudioThresholdSettings.dartì—ì„œ
static const double _VOICE_THRESHOLD = 65.0; // 60.0ì—ì„œ 65.0ìœ¼ë¡œ ë³€ê²½
static const double _SILENCE_THRESHOLD = 40.0; // 35.0ì—ì„œ 40.0ìœ¼ë¡œ ë³€ê²½
```

### ë””ë²„ê¹…
```dart
// í˜„ì¬ ìƒíƒœ í™•ì¸
print('í˜„ì¬ ë ˆë²¨: ${settings.currentLevel}dB');
print('ì„ê³„ê°’: ${settings.threshold}dB');
print('ì°¨ì´: ${settings.levelDifference}dB');
print('ìƒíƒœ: ${settings.voiceStatusDescription}');
```

## ğŸ‰ ê²°ë¡ 

í•˜ë“œì½”ë”©ëœ ì„ê³„ê°’ ì‹œìŠ¤í…œì€ **ì•ˆì •ì„±**, **ë‹¨ìˆœì„±**, **ì„±ëŠ¥** ëª¨ë“  ë©´ì—ì„œ ì´ì „ ì‹œìŠ¤í…œë³´ë‹¤ ìš°ìˆ˜í•©ë‹ˆë‹¤.

- ğŸš€ **ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥**: ë³µì¡í•œ ì„¤ì • ì—†ì´ ë°”ë¡œ ìµœì  ì„±ëŠ¥
- ğŸ¯ **ì™„ë²½í•œ ìŒì„± ê°ì§€**: 60dB ì„ê³„ê°’ìœ¼ë¡œ ë°°ê²½ ì¡ìŒ ì™„ë²½ ì°¨ë‹¨  
- ğŸ”§ **ìœ ì§€ë³´ìˆ˜ ê°„í¸**: ë‹¨ìˆœí•œ ì½”ë“œë¡œ ë²„ê·¸ ìœ„í—˜ ìµœì†Œí™”
- âš¡ **ë¹ ë¥¸ ì„±ëŠ¥**: ë¶ˆí•„ìš”í•œ ë™ì  ì¡°ì • ë¡œì§ ì œê±°

ì´ì œ ì‚¬ìš©ìëŠ” ë³µì¡í•œ ì„ê³„ê°’ ì„¤ì •ì— ì‹ ê²½ ì“¸ í•„ìš” ì—†ì´, **ê¹¨ë—í•˜ê³  ëª…í™•í•œ ìŒì„± ë…¹ìŒ**ì„ ì¦‰ì‹œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ¤âœ¨ 